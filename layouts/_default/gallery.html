{{- define "main" }}

<header class="page-header">
    <h1>{{ .Title }}</h1>
    {{- if .Description }}
    <div class="post-description">
        {{ .Description }}
    </div>
    {{- end }}
</header>

<article class="markdown-content">
    {{ .Content }}
</article>

<div class="gallery-grid">
    {{- $galleryPath := "static/gallery" }}
    {{- range (readDir $galleryPath) }}
        {{- if (findRE "\\.(jpg|jpeg|png|gif)$" .Name) }}
        <div class="gallery-item">
            <a href="/gallery/{{ .Name }}" data-fancybox="gallery" data-caption="{{ replace (replace .Name "-" " " | title) ".jpg" "" }}">
                <img src="/gallery/{{ .Name }}" alt="{{ .Name }}" loading="lazy">
                <div class="gallery-caption">
                    {{ replace (replace .Name "-" " " | title) ".jpg" "" }}
                </div>
            </a>
        </div>
        {{- end }}
    {{- end }}
</div>

<!-- 引入 Fancybox CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css"/>

<!-- 引入 Fancybox JS -->
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>

<!-- 自定义样式 -->
<style>
.gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 25px;
    padding: 20px;
}

.gallery-item {
    position: relative;
    overflow: hidden;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    background: #fff;
}

.gallery-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
}

.gallery-item img {
    width: 100%;
    height: 300px;
    object-fit: cover;
    display: block;
    transition: transform 0.3s ease;
}

.gallery-item:hover img {
    transform: scale(1.05);
}

.gallery-caption {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 15px;
    background: rgba(255,255,255,0.9);
    color: #333;
    font-size: 0.9em;
    transform: translateY(100%);
    transition: transform 0.3s ease;
}

.gallery-item:hover .gallery-caption {
    transform: translateY(0);
}

/* 深色模式适配 */
[data-theme="dark"] .gallery-item {
    background: #2d2d2d;
    box-shadow: 0 4px 15px rgba(255,255,255,0.1);
}

[data-theme="dark"] .gallery-caption {
    background: rgba(45,45,45,0.9);
    color: #fff;
}

/* 响应式设计 */
@media (max-width: 768px) {
    .gallery-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
        padding: 15px;
    }
    
    .gallery-item img {
        height: 200px;
    }
    
    .gallery-caption {
        padding: 10px;
        font-size: 0.8em;
    }
}
</style>

<!-- 初始化 Fancybox -->
<script>
    Fancybox.bind("[data-fancybox]", {
        // 自定义选项
        Carousel: {
            infinite: true,
        },
        Thumbs: {
            autoStart: true,
        },
        Images: {
            zoom: true,
        },
        Toolbar: {
            display: [
                { id: "prev", position: "center" },
                { id: "counter", position: "center" },
                { id: "next", position: "center" },
                "zoom",
                "slideshow",
                "fullscreen",
                "close",
            ],
        },
    });
</script>

{{- end }} 